<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8"/>
    <style>
      #plotarea1 {
        border:1px solid grey;
      }
      #plotarea2 {
        border:1px solid blue;
      }
      #plotarea1 circle {
        fill:red;
      }
    </style>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script>
        d3.select(window).on('load',init);

        function init() {
  
  d3.csv(
    'Los Angeles Weather Data.csv',
    function(error, raw_data) {
      if (error) throw error;  
        
       var data = raw_data.filter(function(d) 
                { 

            if (( parseInt(d.YEAR) >= 1917 ) && ( d.metANN < 990 ) )
            { 
                return d;
            } 

    })
            
        var svg = d3.select('#plotarea1');
        //svg.style('width','800px'); in HTMl
        //svg.style('height','400px');
        var width = +svg.node().getBoundingClientRect().width;
        var height = +svg.node().getBoundingClientRect().height;  
            
          var padding = 30;

          var xScale = d3.scaleLinear()
                           .domain(d3.extent(data,
                                            function(d){
                                              return d.YEAR;
                                            }))
                          .range([ padding , width - padding]);

          var yScale = d3.scaleLinear()
              .domain([d3.min(data, 
                              function(d){
                                return d.metANN;
                              }),
                       d3.max(data, 
                              function(d){
                                return d.metANN;
                              })])
              .range([height-padding, padding]);


            d3.select("#plotarea1")
                .selectAll("circle")
                .data(data)
                .enter()
                .append("circle")
                .attr("r", "5px")
                .attr("cx", function(d){
                              //console.log(d.YEAR)
                              //console.log(""+xScale(d.YEAR))
                              return ""+xScale(d.YEAR)+"px";
                            })
                .attr("cy", function(d){
                              return ""+yScale(d.metANN)+"px";
                            })
            aggregates = []
            for (i=0; i < data.length-1; i++) {
                //console.log(xScale((data[i]).YEAR))
                //console.log(yScale((data[i]).metANN))
                svg.append("line")
                .attr("class", "line")
                .attr("stroke-width","2")
                .attr("stroke","black")
                .attr("x1","" + xScale((data[i]).YEAR)+"px")
                .attr("y1","" + yScale((data[i]).metANN)+"px")
                .attr("x2","" + xScale((data[i+1]).YEAR)+"px")
                .attr("y2","" + yScale((data[i+1]).metANN)+"px");
            }
            //
            
            d3.select('#plotarea1')
              .append('g')            // grouping makes it easy to specify transform
              .attr('transform', 'translate(0,' + (height - padding) + ')')
              .call(d3.axisBottom(xScale).ticks(data.length / 4))           // xAxis will be constructed within selection
            
            d3.select("#plotarea1")
                .append('g')
                .attr('transform', 'translate('+padding+', 0)')
                .call(d3.axisLeft(yScale));
        });
}
      
</script>
<script>
     d3.select(window).on('load',init2);
         function init2(){
    d3.csv(
           'Los Angeles Weather Data.csv',
           function(error, raw_data) {
           if (error) throw error;
           
           var data2 = raw_data.filter(function(d)
                                      {
                                      
                                      if (( parseInt(d.YEAR) >= 1917 ) && ( d.metANN < 990 ) )
                                      { 
                                      return d;
                                      } 
                                      
                                      })

         
        var svg = d3.select('#plotarea2');
        //svg.style('width','800px'); in HTMl
        //svg.style('height','400px');
        var width = +svg.node().getBoundingClientRect().width;
        var height = +svg.node().getBoundingClientRect().height;  
         
         
        var padding = 30;

        var xScale = d3.scaleLinear()
                           .domain(d3.extent(data2,
                                            function(d){
                                              return d.YEAR;
                                            }))
                          .range([ padding , width - padding]);

         var yScale = d3.scaleLinear()
              .domain([d3.min(data2, 
                              function(d){
                                return Math.min(d."D-J-F",d."M-A-M",d."J-J-A",d."S-O-N");
                              }),
                       d3.max(data2, 
                              function(d){
                                return Math.max(d."D-J-F",d."M-A-M",d."J-J-A",d."S-O-N");
                              })])
              .range([height-padding, padding]);
 
             
             var x = d3.scaleBand().rangeRound([0, width])
             .domain(data2.map(function(d) { return d.YEAR; }));
             
             var y = d3.scaleLinear().rangeRound([height, 0])
             .domain([0, d3.max(data2, function(d) { return max(d."D-J-F",d."M-A-M",d."J-J-A",d."S-O-N") })]);
             
             g.append("g")
             .attr("class", "axis x")
             .attr("transform", "translate(0," + height + ")")
             .call(d3.axisBottom(x));
             
             g.append("g")
             .attr("class", "axis y")
             .call(d3.axisLeft(y).ticks(data2.length));
             
             g.selectAll(".bar")
             .data2(data2)
             .enter().append("rect")
             .attr("x", function(d) { return x(d.YEAR); })
             .attr("y", function(d) { return y(Math.max(d."D-J-F",d."M-A-M",d."J-J-A",d."S-O-N")); })
             .attr("width", x.bandwidth())
             .attr("height", function(d) { return height - y(Math.max(d."D-J-F",d."M-A-M",d."J-J-A",d."S-O-N")); });
             

     }
      
      );
         } 
      
      
</script>
      
  </head>
    
  <body>
      <h2>IDE : Assignment 2</h2>
      <h3> How has the weather changed over the past 100 years?</h3>
      
      <svg width="80%" height="500px" id="plotarea1"></svg>
      
      <svg width="80%" height="500px" id="plotarea2"></svg>   
      
      
      
  </body>
    
</html>
